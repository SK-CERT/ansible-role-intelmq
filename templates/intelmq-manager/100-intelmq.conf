<VirtualHost *:80>
	ServerName _default

	ServerAdmin admin@localhost
	DocumentRoot /var/www/html

	servername {{ intelmq_manager.domain }}
	redirect / https://{{ intelmq_manager.domain }}/
	
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

<IfModule mod_ssl.c>
        <VirtualHost *:443>
 		<Directory /usr/share/intelmq-manager/html>
			AuthType basic
			AuthName "IntelmMQ Manager"
			AuthBasicProvider file
			AuthUserFile {{ intelmq_manager.password_file }}
			Require valid-user
			Require all granted
                        Header set Content-Security-Policy "script-src 'self'"
                        Header set X-Content-Security-Policy "script-src 'self'"
		</Directory>

		Options FollowSymLinks

                ServerAdmin admin@localhost
		ServerName {{ intelmq_manager.domain }}

                DocumentRoot /usr/share/intelmq-manager/html/
                ErrorLog ${APACHE_LOG_DIR}/error.log
                CustomLog ${APACHE_LOG_DIR}/access.log combined

                SSLEngine on
                SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem
                SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key
        </VirtualHost>
</IfModule>
